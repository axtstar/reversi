(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

/////////////////////////////////////
//オセロのマス目
//base class
/////////////////////////////////////
var yellowbase = function yellowbase(_baseName, _rpt, _iwidth) {
  var temp = new yellowbase.prototype.create();
  // 引数を渡してinit関数を呼び出す
  return yellowbase.prototype.init.apply(temp, arguments);
};

yellowbase.prototype = {
  //property
  baseName: "",
  rpt: 0,
  iwidth: 0,
  canvas: null,
  context: null,
  othellos: null,
  //function
  create: function create() {
    return this;
  },
  init: function init(_baseName, _rpt, _iwidth) {
    this.baseName = _baseName;
    this.rpt = _rpt;
    this.iwidth = _iwidth;
    this.canvas = document.getElementById(this.baseName);
    this.context = this.canvas.getContext('2d');
    this.othellos = [];
    return this;
  },
  addAll2One: function addAll2One(c) {
    var ts = {};
    for (var x = 0; x < this.rpt; x++) {
      for (var y = 0; y < this.rpt; y++) {
        var e = this.addTrial(x, y, c);
        if (e > 0) {
          ts[x * this.rpt + y] = e;
        }
      }
    }

    var ret = -1;
    var m = -1;
    for (var k in ts) {
      if (m < ts[k]) {
        ret = k;
        m = ts[k];
      }
    }

    if (ret == -1) {
      return 0;
    }

    var xx = ~ ~(ret / this.rpt);
    var yy = ret % this.rpt;
    ret = this.add(xx, yy, c);
    this.draw();
    return ret;
  },
  asistAll: function asistAll(c) {
    var ret = 0;
    for (var x = 0; x < this.rpt; x++) {
      for (var y = 0; y < this.rpt; y++) {
        var e = this.addTrial(x, y, c);
        if (e > 0) {
          var a = othello(x, y, c, this);
          a.drawSmall();
        }
      }
    }
    return ret;
  },
  addTrialAll: function addTrialAll(c) {
    var ret = 0;
    for (var x = 0; x < this.rpt; x++) {
      for (var y = 0; y < this.rpt; y++) {
        var e = this.addTrial(x, y, c);
        ret = ret + e;
      }
    }
    return ret;
  },
  score: function score(_sbt) {
    var ret = 0;
    for (var i = 0; i < this.othellos.length; i++) {
      var cell = this.othellos[i];
      if (cell != null) {
        if (cell.sbt == _sbt) {
          ret++;
        }
      }
    }
    return ret;
  },
  addForce: function addForce(_x, _y, _c) {
    if (this.getOthelloC(_x, _y) == -1) {
      var ox = othello(_x, _y, _c, this);
      this.setOthello(ox);
      $("#" + this.baseName).on('fire', function () {
        ox.draw();
      });
    }
    return;
  },
  addTrial: function addTrial(_x, _y, _c) {
    var ret = 0;
    if (this.getOthelloC(_x, _y) == -1) {
      var ox = othello(_x, _y, _c, this);
      ret = this.doOthello(ox, true);
    }
    return ret;
  },
  add: function add(_x, _y, _c) {
    var ret = 0;
    if (this.getOthelloC(_x, _y) == -1) {
      var ox = othello(_x, _y, _c, this);
      ret = this.doOthello(ox, false);
      if (ret != 0) {
        this.setOthello(ox);
        $("#" + this.baseName).on('fire', function () {
          ox.draw();
        });
      }
    }
    return ret;
  },
  setOthello: function setOthello(_othello) {
    this.othellos.push(_othello);
    return;
  },
  getOthello: function getOthello(_x, _y) {
    for (var i = 0; i < this.othellos.length; i++) {
      var e = this.othellos[i];
      if (e.posX == _x && e.posY == _y) {
        return e;
      }
    }
    return null;
  },
  getOthelloC: function getOthelloC(_x, _y) {
    if (this.getOthello(_x, _y) == null) {
      return -1;
    }
    return this.getOthello(_x, _y).sbt;
  },
  doOthello: function doOthello(_othello, _trial) {
    var ret = 0;
    ret += this.doOthelloDetail(_othello, 0, _trial);
    ret += this.doOthelloDetail(_othello, 1, _trial);
    ret += this.doOthelloDetail(_othello, 2, _trial);
    ret += this.doOthelloDetail(_othello, 3, _trial);
    ret += this.doOthelloDetail(_othello, 4, _trial);
    ret += this.doOthelloDetail(_othello, 5, _trial);
    ret += this.doOthelloDetail(_othello, 6, _trial);
    ret += this.doOthelloDetail(_othello, 7, _trial);

    return ret;
  },
  doOthelloBit: function doOthelloBit(_x, _y, _dim, _num) {
    switch (_num) {
      case 0:
        _x[_dim]++;
        break;
      case 1:
        _x[_dim]--;
        break;
      case 2:
        _y[_dim]++;
        break;
      case 3:
        _y[_dim]--;
        break;
      case 4:
        _x[_dim]++;
        _y[_dim]++;
        break;
      case 5:
        _x[_dim]--;
        _y[_dim]--;
        break;
      case 6:
        _x[_dim]++;
        _y[_dim]--;
        break;
      case 7:
        _x[_dim]--;
        _y[_dim]++;
        break;
    }
    return;
  },
  doOthelloDetail: function doOthelloDetail(_othello, _num, _trial) {
    var ret = 0;

    //
    var x = [];
    var y = [];

    x[0] = _othello.posX;
    y[0] = _othello.posY;

    //隣接しているセルが自分と同じもしくはundefの場合は何もしない
    //隣接

    this.doOthelloBit(x, y, 0, _num);
    if (this.getOthelloC(x[0], y[0]) == -1) {
      return ret;
    }

    if (this.getOthelloC(x[0], y[0]) == _othello.sbt) {
      return ret;
    }

    //隣接から検索
    var cx = null;
    var cy = null;
    x[1] = x[0];
    y[1] = y[0];
    while (0 <= x[1] && x[1] < this.rpt && 0 <= y[1] && y[1] < this.rpt) {
      if (this.getOthelloC(x[1], y[1]) == -1) {
        break;
      }
      if (this.getOthelloC(x[1], y[1]) == _othello.sbt) {
        cx = x[1];
        cy = y[1];
        break;
      }
      //
      this.doOthelloBit(x, y, 1, _num);
    }

    if (cx != null || cy != null) {
      x[1] = _othello.posX;
      y[1] = _othello.posY;
      this.doOthelloBit(x, y, 1, _num);
      x[2] = x[1];
      y[2] = y[1];
      while ((cx - x[2]) * (x[2] - x[1]) >= 0 && (cy - y[2]) * (y[2] - y[1]) >= 0) {
        ret++;
        if (_trial == false) {
          //実際に裏返しする
          this.getOthello(x[2], y[2]).sbt = _othello.sbt;
        }
        this.doOthelloBit(x, y, 2, _num);
      }
    }

    return ret;
  },
  // オセロの描画を行う
  draw: function draw() {
    for (var x = 0; x < this.rpt; x++) {
      for (var y = 0; y < this.rpt; y++) {
        this.context.fillStyle = "green";
        this.context.fillRect(x * this.iwidth, y * this.iwidth, this.iwidth, this.iwidth);
        this.context.strokeStyle = "rgb(0, 0, 0)";
        this.context.strokeRect(x * this.iwidth, y * this.iwidth, this.iwidth, this.iwidth);
      }
    }
    $("#" + this.baseName).trigger('fire');
  }
};

yellowbase.prototype.create.prototype = yellowbase.prototype;

/////////////////////////////////////
//オセロ一個
/////////////////////////////////////
var othello = function othello(_x, _y, _sbt, _base) {
  var temp = new othello.prototype.create();
  return othello.prototype.init.apply(temp, arguments);
};

othello.prototype = {
  //property
  posX: -1,
  posY: -1,
  sbt: -1,
  parent: null,
  create: function create() {
    return this;
  },
  init: function init(_x, _y, _sbt, _base) {
    this.posX = _x;
    this.posY = _y;
    this.sbt = _sbt;
    this.parent = _base;
    return this;
  },
  clear: function clear() {
    this.posX = -1;
    this.posY = -1;
    this.sbt = -1;
  },
  draw: function draw() {
    //drawing othello
    var xx = this.parent.iwidth / 2;

    this.parent.context.beginPath();
    var fillColor = this.sbt == 0 ? 'rgb(0,0,0)' : 'rgb(255,255,255)';
    this.parent.context.strokeStyle = fillColor;
    this.parent.context.fillStyle = fillColor;
    this.parent.context.arc(this.posX * this.parent.iwidth + xx, this.posY * this.parent.iwidth + xx, xx - 2, 0, Math.PI * 2, false);
    this.parent.context.fill();
  },
  drawSmall: function drawSmall() {
    var xx = this.parent.iwidth / 2;
    this.parent.context.beginPath();
    var strokeColor = this.sbt == 0 ? 'rgb(0,0,0)' : 'rgb(255,255,255)';
    this.parent.context.strokeStyle = strokeColor;
    this.parent.context.arc(this.posX * this.parent.iwidth + xx, this.posY * this.parent.iwidth + xx, xx / 2, 0, Math.PI * 2, false);
    this.parent.context.stroke();
  }
};

othello.prototype.create.prototype = othello.prototype;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAuanN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FDSUEsSUFBSSxhQUFhLFNBQWIsVUFBYSxDQUFTLFNBQVQsRUFBb0IsSUFBcEIsRUFBMEIsT0FBMUIsRUFBa0M7QUFDakQsTUFBSSxPQUFLLElBQUksV0FBVyxTQUFYLENBQXFCLE1BQXJCLEVBQVQ7O0FBRDZDLFNBRzFDLFdBQVcsU0FBWCxDQUFxQixJQUFyQixDQUEwQixLQUExQixDQUFnQyxJQUFoQyxFQUFzQyxTQUF0QyxDQUFQLENBSGlEO0NBQWxDOztBQU1qQixXQUFXLFNBQVgsR0FBdUI7O0FBRXJCLFlBQVMsRUFBVDtBQUNBLE9BQUksQ0FBSjtBQUNBLFVBQU8sQ0FBUDtBQUNBLFVBQU8sSUFBUDtBQUNBLFdBQVEsSUFBUjtBQUNBLFlBQVcsSUFBWDs7QUFFQSxVQUFPLGtCQUFVO0FBQ2YsV0FBTyxJQUFQLENBRGU7R0FBVjtBQUdQLFFBQUssY0FBVSxTQUFWLEVBQXFCLElBQXJCLEVBQTBCLE9BQTFCLEVBQWtDO0FBQ3JDLFNBQUssUUFBTCxHQUFlLFNBQWYsQ0FEcUM7QUFFckMsU0FBSyxHQUFMLEdBQVMsSUFBVCxDQUZxQztBQUdyQyxTQUFLLE1BQUwsR0FBWSxPQUFaLENBSHFDO0FBSXJDLFNBQUssTUFBTCxHQUFZLFNBQVMsY0FBVCxDQUF3QixLQUFLLFFBQUwsQ0FBcEMsQ0FKcUM7QUFLckMsU0FBSyxPQUFMLEdBQWEsS0FBSyxNQUFMLENBQVksVUFBWixDQUF1QixJQUF2QixDQUFiLENBTHFDO0FBTXJDLFNBQUssUUFBTCxHQUFnQixFQUFoQixDQU5xQztBQU9yQyxXQUFPLElBQVAsQ0FQcUM7R0FBbEM7QUFTTCxjQUFhLG9CQUFTLENBQVQsRUFBVztBQUN0QixRQUFJLEtBQUssRUFBTCxDQURrQjtBQUV0QixTQUFJLElBQUksSUFBRSxDQUFG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QUFZLEtBQUssTUFBTCxDQUFZLE1BQVosR0FBcUIsRUFBakMsRUFBcUMsS0FBSyxDQUFMLEVBQVEsQ0FBMUcsRUFBOEcsS0FBSyxFQUFMLEdBQVUsQ0FBVixFQUFhLEtBQTNILEVBUmM7QUFTZCxTQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLElBQXBCLEdBVGM7R0FBVjtBQVdQLGFBQVkscUJBQVU7QUFDbkIsUUFBSSxLQUFLLEtBQUssTUFBTCxDQUFZLE1BQVosR0FBcUIsQ0FBckIsQ0FEVTtBQUVuQixTQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLFNBQXBCLEdBRm1CO0FBR25CLFFBQUksY0FBYyxLQUFLLEdBQUwsSUFBVSxDQUFWLEdBQWMsWUFBZCxHQUE2QixrQkFBN0IsQ0FIQztBQUluQixTQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLFdBQXBCLEdBQWtDLFdBQWxDLENBSm1CO0FBS25CLFNBQUssTUFBTCxDQUFZLE9BQVosQ0FBb0IsR0FBcEIsQ0FBd0IsS0FBSyxJQUFMLEdBQVksS0FBSyxNQUFMLENBQVksTUFBWixHQUFxQixFQUFqQyxFQUFxQyxLQUFLLElBQUwsR0FBWSxLQUFLLE1BQUwsQ0FBWSxNQUFaLEdBQXFCLEVBQWpDLEVBQXFDLEtBQUssQ0FBTCxFQUFTLENBQTNHLEVBQStHLEtBQUssRUFBTCxHQUFVLENBQVYsRUFBYSxLQUE1SCxFQUxtQjtBQU1uQixTQUFLLE1BQUwsQ0FBWSxPQUFaLENBQW9CLE1BQXBCLEdBTm1CO0dBQVY7Q0FoQ2Q7O0FBMENBLFFBQVEsU0FBUixDQUFrQixNQUFsQixDQUF5QixTQUF6QixHQUFtQyxRQUFRLFNBQVIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy/jgqrjgrvjg63jga7jg57jgrnnm65cbi8vYmFzZSBjbGFzc1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xudmFyIHllbGxvd2Jhc2UgPSBmdW5jdGlvbihfYmFzZU5hbWUsIF9ycHQsIF9pd2lkdGgpe1xuICB2YXIgdGVtcD1uZXcgeWVsbG93YmFzZS5wcm90b3R5cGUuY3JlYXRlKCk7XG4gIC8vIOW8leaVsOOCkua4oeOBl+OBpmluaXTplqLmlbDjgpLlkbzjgbPlh7rjgZlcbiAgcmV0dXJuIHllbGxvd2Jhc2UucHJvdG90eXBlLmluaXQuYXBwbHkodGVtcCwgYXJndW1lbnRzKTtcbn1cblxueWVsbG93YmFzZS5wcm90b3R5cGUgPSB7XG4gIC8vcHJvcGVydHlcbiAgYmFzZU5hbWU6XCJcIixcbiAgcnB0OjAsXG4gIGl3aWR0aDowLFxuICBjYW52YXM6bnVsbCxcbiAgY29udGV4dDpudWxsLFxuICBvdGhlbGxvcyA6IG51bGwsXG4gIC8vZnVuY3Rpb25cbiAgY3JlYXRlOmZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGluaXQ6ZnVuY3Rpb24oIF9iYXNlTmFtZSAsX3JwdCxfaXdpZHRoKXtcbiAgICB0aGlzLmJhc2VOYW1lPSBfYmFzZU5hbWU7XG4gICAgdGhpcy5ycHQ9X3JwdDtcbiAgICB0aGlzLml3aWR0aD1faXdpZHRoO1xuICAgIHRoaXMuY2FudmFzPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuYmFzZU5hbWUpO1xuICAgIHRoaXMuY29udGV4dD10aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMub3RoZWxsb3MgPSBbXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgYWRkQWxsMk9uZSA6IGZ1bmN0aW9uKGMpe1xuICAgIHZhciB0cyA9IHt9O1xuICAgIGZvcih2YXIgeD0wOyB4IDwgdGhpcy5ycHQgOyB4Kyspe1xuICAgICAgZm9yKHZhciB5PTA7IHkgPCB0aGlzLnJwdCA7IHkrKyl7XG4gICAgICAgIHZhciBlID0gdGhpcy5hZGRUcmlhbCh4LHksYyk7XG4gICAgICAgIGlmIChlID4gMCl7XG4gICAgICAgICAgdHNbeCAqIHRoaXMucnB0ICsgeV09ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHZhciByZXQgPSAtMTtcbiAgICB2YXIgbSA9IC0xO1xuICAgIGZvciAodmFyIGsgaW4gdHMpe1xuICAgICAgaWYgKG0gPCB0c1trXSl7XG4gICAgICAgIHJldCA9IGs7XG4gICAgICAgIG0gPSB0c1trXTtcbiAgICAgIH1cbiAgICB9XG4gIFxuICAgIGlmIChyZXQ9PS0xKXtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIHZhciB4eCA9IH5+KHJldCAvIHRoaXMucnB0KTtcbiAgICB2YXIgeXkgPSByZXQgJSB0aGlzLnJwdDtcbiAgICByZXQgPSB0aGlzLmFkZCh4eCx5eSxjKTtcbiAgICB0aGlzLmRyYXcoKTtcbiAgICByZXR1cm4gcmV0O1xuICB9LFxuICBhc2lzdEFsbCA6IGZ1bmN0aW9uIChjKXtcbiAgICB2YXIgcmV0ID0gMDtcbiAgICBmb3IodmFyIHg9MDsgeCA8IHRoaXMucnB0IDsgeCsrKXtcbiAgICAgIGZvcih2YXIgeT0wOyB5IDwgdGhpcy5ycHQgOyB5Kyspe1xuICAgICAgICB2YXIgZSA9IHRoaXMuYWRkVHJpYWwoeCx5LGMpO1xuICAgICAgICBpZiAoZSA+IDApe1xuICAgICAgICAgIHZhciBhID0gb3RoZWxsbyh4LHksYyx0aGlzKTtcbiAgICAgICAgICBhLmRyYXdTbWFsbCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIGFkZFRyaWFsQWxsIDogZnVuY3Rpb24gKGMpe1xuICAgIHZhciByZXQgPSAwO1xuICAgIGZvcih2YXIgeD0wOyB4IDwgdGhpcy5ycHQgOyB4Kyspe1xuICAgICAgZm9yKHZhciB5PTA7IHkgPCB0aGlzLnJwdCA7IHkrKyl7XG4gICAgICAgIHZhciBlID0gdGhpcy5hZGRUcmlhbCh4LHksYyk7XG4gICAgICAgIHJldCA9IHJldCArIGU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIHNjb3JlIDogZnVuY3Rpb24oX3NidCl7XG4gICAgdmFyIHJldCA9IDA7XG4gICAgZm9yKHZhciBpPTA7IGkgPCB0aGlzLm90aGVsbG9zLmxlbmd0aCA7IGkrKyl7XG4gICAgICB2YXIgY2VsbCA9ICB0aGlzLm90aGVsbG9zW2ldO1xuICAgICAgaWYgKCBjZWxsICE9IG51bGwgKXtcbiAgICAgICAgaWYgKCBjZWxsLnNidCA9PSBfc2J0ICl7IHJldCsrOyB9XG4gICAgICB9ICAgIFxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9LFxuICBhZGRGb3JjZTpmdW5jdGlvbihfeCxfeSxfYyl7XG4gICAgaWYgKHRoaXMuZ2V0T3RoZWxsb0MoX3gsIF95KT09LTEpe1xuICAgICAgdmFyIG94PSBvdGhlbGxvKF94LF95LF9jLHRoaXMpO1xuICAgICAgdGhpcy5zZXRPdGhlbGxvKG94KTtcbiAgICAgICQoXCIjXCIgKyB0aGlzLmJhc2VOYW1lKS5vbignZmlyZScsIGZ1bmN0aW9uKCl7b3guZHJhdygpO30pO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH0sXG4gIGFkZFRyaWFsOmZ1bmN0aW9uKF94LF95LF9jKXtcbiAgICB2YXIgcmV0ID0gMDtcbiAgICBpZiAodGhpcy5nZXRPdGhlbGxvQyhfeCwgX3kpPT0tMSl7XG4gICAgICB2YXIgb3g9IG90aGVsbG8oX3gsX3ksX2MsdGhpcyk7XG4gICAgICByZXQgPSB0aGlzLmRvT3RoZWxsbyhveCx0cnVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldDtcbiAgfSxcbiAgYWRkOmZ1bmN0aW9uKF94LF95LF9jKXtcbiAgICB2YXIgcmV0ID0gMDtcbiAgICBpZiAodGhpcy5nZXRPdGhlbGxvQyhfeCwgX3kpPT0tMSl7XG4gICAgICB2YXIgb3g9IG90aGVsbG8oX3gsX3ksX2MsdGhpcyk7XG4gICAgICByZXQgPSB0aGlzLmRvT3RoZWxsbyhveCxmYWxzZSk7XG4gICAgICBpZiAocmV0IT0wKXtcbiAgICAgICAgdGhpcy5zZXRPdGhlbGxvKG94KTtcbiAgICAgICAgJChcIiNcIiArIHRoaXMuYmFzZU5hbWUpLm9uKCdmaXJlJywgZnVuY3Rpb24oKXtveC5kcmF3KCk7fSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIHNldE90aGVsbG86ZnVuY3Rpb24oX290aGVsbG8pe1xuICAgIHRoaXMub3RoZWxsb3MucHVzaChfb3RoZWxsbyk7XG4gICAgcmV0dXJuO1xuICB9LFxuICBnZXRPdGhlbGxvOmZ1bmN0aW9uKF94LF95KXtcbiAgICBmb3IgKHZhciBpPTA7aTx0aGlzLm90aGVsbG9zLmxlbmd0aDtpKyspe1xuICAgICAgdmFyIGUgPSB0aGlzLm90aGVsbG9zW2ldO1xuICAgICAgaWYgKGUucG9zWCA9PSBfeCAmJiBlLnBvc1k9PV95KXtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9LFxuICBnZXRPdGhlbGxvQzpmdW5jdGlvbihfeCxfeSl7XG4gICAgaWYgKHRoaXMuZ2V0T3RoZWxsbyhfeCxfeSk9PW51bGwpe1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nZXRPdGhlbGxvKF94LF95KS5zYnQ7IFxuICB9LFxuICBkb090aGVsbG86ZnVuY3Rpb24oX290aGVsbG8sX3RyaWFsKXtcbiAgICB2YXIgcmV0ID0gMDtcbiAgICByZXQgKz0gdGhpcy5kb090aGVsbG9EZXRhaWwoX290aGVsbG8sMCxfdHJpYWwpO1xuICAgIHJldCArPSB0aGlzLmRvT3RoZWxsb0RldGFpbChfb3RoZWxsbywxLF90cmlhbCk7XG4gICAgcmV0ICs9IHRoaXMuZG9PdGhlbGxvRGV0YWlsKF9vdGhlbGxvLDIsX3RyaWFsKTtcbiAgICByZXQgKz0gdGhpcy5kb090aGVsbG9EZXRhaWwoX290aGVsbG8sMyxfdHJpYWwpO1xuICAgIHJldCArPSB0aGlzLmRvT3RoZWxsb0RldGFpbChfb3RoZWxsbyw0LF90cmlhbCk7XG4gICAgcmV0ICs9IHRoaXMuZG9PdGhlbGxvRGV0YWlsKF9vdGhlbGxvLDUsX3RyaWFsKTtcbiAgICByZXQgKz0gdGhpcy5kb090aGVsbG9EZXRhaWwoX290aGVsbG8sNixfdHJpYWwpO1xuICAgIHJldCArPSB0aGlzLmRvT3RoZWxsb0RldGFpbChfb3RoZWxsbyw3LF90cmlhbCk7XG4gICAgXG4gICAgcmV0dXJuIHJldDtcbiAgfSxcbiAgZG9PdGhlbGxvQml0OmZ1bmN0aW9uKF94LF95LF9kaW0sX251bSl7XG4gICAgc3dpdGNoKF9udW0pe1xuICAgICAgY2FzZSAwOlxuICAgICAgICBfeFtfZGltXSsrO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgX3hbX2RpbV0tLTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIF95W19kaW1dKys7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBfeVtfZGltXS0tO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgX3hbX2RpbV0rKztcbiAgICAgICAgX3lbX2RpbV0rKztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDU6XG4gICAgICAgIF94W19kaW1dLS07XG4gICAgICAgIF95W19kaW1dLS07XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA2OlxuICAgICAgICBfeFtfZGltXSsrO1xuICAgICAgICBfeVtfZGltXS0tOyAgICAgXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSA3OlxuICAgICAgICBfeFtfZGltXS0tO1xuICAgICAgICBfeVtfZGltXSsrOyAgICAgXG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH0sXG4gIGRvT3RoZWxsb0RldGFpbDpmdW5jdGlvbihfb3RoZWxsbyxfbnVtLF90cmlhbCl7XG4gICAgdmFyIHJldCA9IDA7XG4gICAgXG4gICAgLy9cbiAgICB2YXIgeCA9IFtdO1xuICAgIHZhciB5ID0gW107XG5cbiAgICB4WzBdID0gX290aGVsbG8ucG9zWDtcbiAgICB5WzBdID0gX290aGVsbG8ucG9zWTtcblxuICAgIC8v6Zqj5o6l44GX44Gm44GE44KL44K744Or44GM6Ieq5YiG44Go5ZCM44GY44KC44GX44GP44GvdW5kZWbjga7loLTlkIjjga/kvZXjgoLjgZfjgarjgYRcbiAgICAvL+mao+aOpVxuICAgIFxuICAgIHRoaXMuZG9PdGhlbGxvQml0KHgseSwwLF9udW0pO1xuICAgIGlmICh0aGlzLmdldE90aGVsbG9DKHhbMF0sIHlbMF0pPT0tMSl7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIGlmICggdGhpcy5nZXRPdGhlbGxvQyh4WzBdLCB5WzBdKT09X290aGVsbG8uc2J0KXtcbiAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgLy/pmqPmjqXjgYvjgonmpJzntKJcbiAgICB2YXIgY3ggPSBudWxsO1xuICAgIHZhciBjeSA9IG51bGw7XG4gICAgeFsxXSA9IHhbMF07XG4gICAgeVsxXSA9IHlbMF07XG4gICAgd2hpbGUoMCA8PSB4WzFdICYmIHhbMV0gPCB0aGlzLnJwdCAmJiAwIDw9IHlbMV0gJiYgeVsxXSA8IHRoaXMucnB0KXtcbiAgICAgIGlmICh0aGlzLmdldE90aGVsbG9DKHhbMV0seVsxXSk9PS0xKXtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5nZXRPdGhlbGxvQyh4WzFdLHlbMV0pPT1fb3RoZWxsby5zYnQpe1xuICAgICAgICBjeCA9IHhbMV07XG4gICAgICAgIGN5ID0geVsxXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICAvL1xuICAgICAgdGhpcy5kb090aGVsbG9CaXQoeCx5LDEsX251bSk7XG4gICAgfVxuXG4gICAgaWYgKGN4IT1udWxsIHx8IGN5IT1udWxsKXtcbiAgICAgIHhbMV0gPSBfb3RoZWxsby5wb3NYO1xuICAgICAgeVsxXSA9IF9vdGhlbGxvLnBvc1k7XG4gICAgICB0aGlzLmRvT3RoZWxsb0JpdCh4LHksMSxfbnVtKTtcbiAgICAgIHhbMl0gPSAgeFsxXTtcbiAgICAgIHlbMl0gPSAgeVsxXTtcbiAgICAgIHdoaWxlKCAoY3ggLSB4WzJdKSooeFsyXSAtIHhbMV0pID49MCAmJiAoY3kgLSB5WzJdKSooeVsyXSAtIHlbMV0pID49MCApe1xuICAgICAgICByZXQrKztcbiAgICAgICAgaWYgKF90cmlhbD09ZmFsc2Upe1xuICAgICAgICAgIC8v5a6f6Zqb44Gr6KOP6L+U44GX44GZ44KLXG4gICAgICAgICAgdGhpcy5nZXRPdGhlbGxvKHhbMl0seVsyXSkuc2J0ID1fb3RoZWxsby5zYnQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kb090aGVsbG9CaXQoeCx5LDIsX251bSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIC8vIOOCquOCu+ODreOBruaPj+eUu+OCkuihjOOBhlxuICBkcmF3OmZ1bmN0aW9uKCl7XG4gICAgZm9yICh2YXIgeD0wOyB4IDwgdGhpcy5ycHQgOyB4KyspXG4gICAge1xuICAgICAgIGZvciAodmFyIHk9MDsgeSA8IHRoaXMucnB0IDsgeSsrKVxuICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBcImdyZWVuXCI7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFJlY3QoeCAqIHRoaXMuaXdpZHRoLCB5ICogdGhpcy5pd2lkdGggLHRoaXMuaXdpZHRoLHRoaXMuaXdpZHRoKTsgXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJnYigwLCAwLCAwKVwiO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZVJlY3QoeCAqIHRoaXMuaXdpZHRoLCB5ICogdGhpcy5pd2lkdGggLHRoaXMuaXdpZHRoLHRoaXMuaXdpZHRoKTsgXG4gICAgICAgfVxuICAgIH1cbiAgICAkKFwiI1wiICsgdGhpcy5iYXNlTmFtZSkudHJpZ2dlcignZmlyZScpO1xuICB9XG59XG5cbnllbGxvd2Jhc2UucHJvdG90eXBlLmNyZWF0ZS5wcm90b3R5cGU9eWVsbG93YmFzZS5wcm90b3R5cGU7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8v44Kq44K744Ot5LiA5YCLXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG52YXIgb3RoZWxsbyA9IGZ1bmN0aW9uKF94LCBfeSwgX3NidCxfYmFzZSl7XG4gIHZhciB0ZW1wID0gbmV3IG90aGVsbG8ucHJvdG90eXBlLmNyZWF0ZSgpO1xuICByZXR1cm4gb3RoZWxsby5wcm90b3R5cGUuaW5pdC5hcHBseSh0ZW1wLCBhcmd1bWVudHMpO1xufVxuXG5vdGhlbGxvLnByb3RvdHlwZSA9IHtcbiAgLy9wcm9wZXJ0eVxuICBwb3NYOiAtMSxcbiAgcG9zWTogLTEsXG4gIHNidDogLTEsXG4gIHBhcmVudCA6IG51bGwsXG4gIGNyZWF0ZSA6IGZ1bmN0aW9uKCl7XG4gICByZXR1cm4gdGhpcztcbiAgfSxcbiAgaW5pdCA6IGZ1bmN0aW9uKF94LCBfeSwgX3NidCxfYmFzZSl7XG4gICAgdGhpcy5wb3NYICA9IF94O1xuICAgIHRoaXMucG9zWSAgPSBfeTtcbiAgICB0aGlzLnNidCA9IF9zYnQ7XG4gICAgdGhpcy5wYXJlbnQgPSBfYmFzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgY2xlYXIgOiBmdW5jdGlvbigpe1xuICAgIHRoaXMucG9zWCA9IC0xO1xuICAgIHRoaXMucG9zWSA9IC0xO1xuICAgIHRoaXMuc2J0ID0gLTE7XG4gIH0sXG4gIGRyYXcgOiBmdW5jdGlvbigpe1xuICAgICAvL2RyYXdpbmcgb3RoZWxsb1xuICAgICB2YXIgeHggPSB0aGlzLnBhcmVudC5pd2lkdGggLyAyO1xuICAgICBcbiAgICAgdGhpcy5wYXJlbnQuY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgdmFyIGZpbGxDb2xvcj0gKHRoaXMuc2J0PT0wID8gJ3JnYigwLDAsMCknIDogJ3JnYigyNTUsMjU1LDI1NSknKTtcbiAgICAgdGhpcy5wYXJlbnQuY29udGV4dC5zdHJva2VTdHlsZSA9IGZpbGxDb2xvcjtcbiAgICAgdGhpcy5wYXJlbnQuY29udGV4dC5maWxsU3R5bGUgPSBmaWxsQ29sb3I7XG4gICAgIHRoaXMucGFyZW50LmNvbnRleHQuYXJjKHRoaXMucG9zWCAqIHRoaXMucGFyZW50Lml3aWR0aCArIHh4LCB0aGlzLnBvc1kgKiB0aGlzLnBhcmVudC5pd2lkdGggKyB4eCwgeHggLSAyLCAwICwgTWF0aC5QSSAqIDIsIGZhbHNlKTtcbiAgICAgdGhpcy5wYXJlbnQuY29udGV4dC5maWxsKCk7XG4gIH0sXG4gIGRyYXdTbWFsbCA6IGZ1bmN0aW9uKCl7XG4gICAgIHZhciB4eCA9IHRoaXMucGFyZW50Lml3aWR0aCAvIDI7ICAgICBcbiAgICAgdGhpcy5wYXJlbnQuY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgdmFyIHN0cm9rZUNvbG9yPSAodGhpcy5zYnQ9PTAgPyAncmdiKDAsMCwwKScgOiAncmdiKDI1NSwyNTUsMjU1KScpO1xuICAgICB0aGlzLnBhcmVudC5jb250ZXh0LnN0cm9rZVN0eWxlID0gc3Ryb2tlQ29sb3I7XG4gICAgIHRoaXMucGFyZW50LmNvbnRleHQuYXJjKHRoaXMucG9zWCAqIHRoaXMucGFyZW50Lml3aWR0aCArIHh4LCB0aGlzLnBvc1kgKiB0aGlzLnBhcmVudC5pd2lkdGggKyB4eCwgeHggLyAyICwgMCAsIE1hdGguUEkgKiAyLCBmYWxzZSk7XG4gICAgIHRoaXMucGFyZW50LmNvbnRleHQuc3Ryb2tlKCk7XG4gIH1cbn1cblxub3RoZWxsby5wcm90b3R5cGUuY3JlYXRlLnByb3RvdHlwZT1vdGhlbGxvLnByb3RvdHlwZTtcblxuXG5cblxuXG5cbiJdfQ==
